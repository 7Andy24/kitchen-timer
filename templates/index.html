<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kitchen Timer</title>
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Kitchen Timer</h1>

    <input type="number" id="minutes" placeholder="Minutes">
    <input type="number" id="seconds" placeholder="Seconds">
    <br><br>
    <button onclick="startTimer()">Start</button>
    <button onclick="repeatTimer()">Repeat</button>
    <button onclick="pauseResumeTimer()">‚èØ Pause / Resume</button>

    <button onclick="toggleDarkMode()">üåô Toggle Dark Mode</button>

    <h2 id="display">00:00</h2>

    <audio id="alarmSound" src="{{ url_for('static', filename='Ringtone-1-timer.mp3') }}"></audio>

    <script>
    let lastMinutes = 0;
    let lastSeconds = 0;
    let interval;
    let total = 0;
    let isPaused = false;

    function startTimer() {
        const minutesInput = parseInt(document.getElementById("minutes").value) || 0;
        const secondsInput = parseInt(document.getElementById("seconds").value) || 0;

        lastMinutes = minutesInput;
        lastSeconds = secondsInput;

        total = minutesInput * 60 + secondsInput;
        isPaused = false;

        runTimer();
    }

    function repeatTimer() {
        total = lastMinutes * 60 + lastSeconds;
        isPaused = false;
        runTimer();
    }

    function pauseResumeTimer() {
        isPaused = !isPaused;

        if (!isPaused) {
            runTimer(); // resume
        } else {
            clearInterval(interval); // pause
        }
    }

    function runTimer() {
        clearInterval(interval);

        interval = setInterval(() => {
            if (!isPaused) {
                let min = Math.floor(total / 60);
                let sec = total % 60;

                document.getElementById("display").textContent =
                    String(min).padStart(2, '0') + ":" + String(sec).padStart(2, '0');

                total--;

                if (total < 0) {
                    clearInterval(interval);
                    const sound = document.getElementById("alarmSound");
                    sound.currentTime = 0;
                    sound.play().catch((e) => {
                        console.log("Sound play error:", e);
                    });
                    setTimeout(() => {
                        alert("Time's up!");
                    }, 500);
                }
            }
        }, 1000);
    }
</script>    
</body>
</html>
